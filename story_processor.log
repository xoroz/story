2025-03-18 01:33:30,028 - StoryProcessor - INFO - Starting story processor. Monitoring queue every 10 seconds
2025-03-18 01:37:20,037 - StoryProcessor - INFO - Found 1 requests in queue
2025-03-18 01:37:20,038 - StoryProcessor - INFO - Processing request: 9a399dec-be45-46b4-b38a-bd0d4427ff10
2025-03-18 01:37:46,033 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 01:37:46,039 - StoryProcessor - ERROR - Error processing request 9a399dec-be45-46b4-b38a-bd0d4427ff10: name 'request_id' is not defined
2025-03-18 01:44:36,238 - StoryProcessor - INFO - Keyboard interrupt received. Shutting down.
2025-03-18 01:44:38,204 - StoryProcessor - INFO - Starting story processor. Monitoring queue every 10 seconds
2025-03-18 01:45:38,207 - StoryProcessor - INFO - Found 1 requests in queue
2025-03-18 01:45:38,207 - StoryProcessor - INFO - Processing request: fc6427a5-ebe0-4a89-90cf-00b2174bd7d3
2025-03-18 01:46:06,095 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 01:46:06,108 - StoryProcessor - ERROR - Error processing request fc6427a5-ebe0-4a89-90cf-00b2174bd7d3: story_to_html() missing 1 required positional argument: 'request_id'
2025-03-18 01:51:53,040 - StoryProcessor - INFO - Keyboard interrupt received. Shutting down.
2025-03-18 01:51:54,987 - StoryProcessor - INFO - Starting story processor. Monitoring queue every 10 seconds
2025-03-18 01:52:24,989 - StoryProcessor - INFO - Found 1 requests in queue
2025-03-18 01:52:24,989 - StoryProcessor - INFO - Processing request: c877e9a4-3b46-4765-ad1a-af6a9c0aae8e
2025-03-18 01:52:24,990 - StoryProcessor - INFO - Asking GPT, Generating story for 6-8 on theme school with characters diego,john
2025-03-18 01:52:28,655 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 01:52:28,660 - StoryProcessor - INFO - Done with GPT, Generated story for 6-8 on theme school with characters diego,john
2025-03-18 01:52:28,660 - StoryProcessor - INFO - Story saved: animal-walker_20250318015228.html
2025-03-18 01:54:39,428 - StoryProcessor - INFO - Keyboard interrupt received. Shutting down.
2025-03-18 02:10:00,408 - StoryProcessor - INFO - Starting story processor. Monitoring queue every 10 seconds
2025-03-18 02:10:00,408 - StoryProcessor - INFO - Found 1 requests in queue
2025-03-18 02:10:00,408 - StoryProcessor - INFO - Processing request: ac4199bb-c3e6-4af3-88db-2770e7bfa1a6
2025-03-18 02:10:01,057 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-18 02:10:01,058 - StoryProcessor - ERROR - Error generating story: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-18 02:10:01,059 - StoryProcessor - ERROR - Error processing request ac4199bb-c3e6-4af3-88db-2770e7bfa1a6: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-18 02:17:10,311 - StoryProcessor - INFO - Keyboard interrupt received. Shutting down.
2025-03-18 02:17:12,547 - StoryProcessor - INFO - Starting story processor. Monitoring queue every 10 seconds
2025-03-18 02:18:02,549 - StoryProcessor - INFO - Found 1 requests in queue
2025-03-18 02:18:02,550 - StoryProcessor - INFO - Processing request: 9cebb5d9-6ff7-42f8-b2fa-79a57e141bbc
2025-03-18 02:18:06,765 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 02:18:06,770 - StoryProcessor - INFO - Generating audio for request: 9cebb5d9-6ff7-42f8-b2fa-79a57e141bbc
2025-03-18 02:18:08,390 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/speech "HTTP/1.1 200 OK"
2025-03-18 02:18:23,023 - StoryProcessor - INFO - Audio generated: 9cebb5d9-6ff7-42f8-b2fa-79a57e141bbc.mp3
2025-03-18 02:18:23,024 - StoryProcessor - INFO - Story saved: tiger-bobo-walk-in-the-park_20250318021823.html
2025-03-18 02:34:05,007 - StoryProcessor - INFO - Keyboard interrupt received. Shutting down.
2025-03-18 02:34:08,457 - StoryProcessor - INFO - Starting story processor. Monitoring queue every 10 seconds
2025-03-18 02:35:08,460 - StoryProcessor - INFO - Found 1 requests in queue
2025-03-18 02:35:08,460 - StoryProcessor - INFO - Processing request: df4ee441-3f77-45d4-9620-444fb580d0f8
2025-03-18 02:35:08,461 - StoryProcessor - INFO - Using DeepSeek backend for request: df4ee441-3f77-45d4-9620-444fb580d0f8
2025-03-18 02:35:08,461 - StoryProcessor - ERROR - Error processing request df4ee441-3f77-45d4-9620-444fb580d0f8: name 'DEEPSEEK_API_KEY' is not defined
2025-03-18 02:35:19,469 - StoryProcessor - INFO - Keyboard interrupt received. Shutting down.
2025-03-18 02:36:12,439 - StoryProcessor - INFO - Starting story processor. Monitoring queue every 10 seconds
2025-03-18 02:36:12,439 - StoryProcessor - INFO - Found 1 requests in queue
2025-03-18 02:36:12,439 - StoryProcessor - INFO - Processing request: fc6427a5-ebe0-4a89-90cf-00b2174bd7d3
2025-03-18 02:36:12,440 - StoryProcessor - INFO - Using OpenAI backend for request: fc6427a5-ebe0-4a89-90cf-00b2174bd7d3
2025-03-18 02:36:12,440 - StoryProcessor - ERROR - Error processing request fc6427a5-ebe0-4a89-90cf-00b2174bd7d3: 'language'
2025-03-18 02:36:21,031 - StoryProcessor - INFO - Keyboard interrupt received. Shutting down.
2025-03-18 02:37:21,925 - StoryProcessor - INFO - Starting story processor. Monitoring queue every 10 seconds
2025-03-18 02:38:11,927 - StoryProcessor - INFO - Found 1 requests in queue
2025-03-18 02:38:11,928 - StoryProcessor - INFO - Processing request: d3416a23-9cb8-4388-bc65-43a28801b901
2025-03-18 02:38:11,928 - StoryProcessor - INFO - Using DeepSeek backend for request: d3416a23-9cb8-4388-bc65-43a28801b901
2025-03-18 02:38:11,929 - StoryProcessor - ERROR - Error generating story with DeepSeek: name 'requests' is not defined
2025-03-18 02:38:11,929 - StoryProcessor - ERROR - Error processing request d3416a23-9cb8-4388-bc65-43a28801b901: name 'requests' is not defined
2025-03-18 02:41:18,747 - StoryProcessor - INFO - Keyboard interrupt received. Shutting down.
2025-03-18 02:42:08,636 - StoryProcessor - INFO - Starting story processor. Monitoring queue every 10 seconds
2025-03-18 02:46:08,645 - StoryProcessor - INFO - Found 1 requests in queue
2025-03-18 02:46:08,645 - StoryProcessor - INFO - Processing request: 27f286fb-9bc2-4e48-92ec-053d138e1a94
2025-03-18 02:46:08,645 - StoryProcessor - INFO - Using DeepSeek backend for request: 27f286fb-9bc2-4e48-92ec-053d138e1a94
2025-03-18 02:46:58,758 - StoryProcessor - INFO - Generating audio for request: 27f286fb-9bc2-4e48-92ec-053d138e1a94
2025-03-18 02:47:00,430 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/speech "HTTP/1.1 200 OK"
2025-03-18 02:47:44,061 - StoryProcessor - INFO - Audio generated: 27f286fb-9bc2-4e48-92ec-053d138e1a94.mp3
2025-03-18 02:47:44,061 - StoryProcessor - INFO - Story saved: learn-to-be-good-at-school_20250318024744.html
2025-03-18 02:49:22,597 - StoryProcessor - INFO - Keyboard interrupt received. Shutting down.
2025-03-18 02:49:38,689 - StoryProcessor - INFO - Starting story processor. Monitoring queue every 10 seconds
2025-03-18 08:29:39,469 - StoryProcessor - INFO - Found 1 requests in queue
2025-03-18 08:29:39,470 - StoryProcessor - INFO - Processing request: 803458da-44eb-4f90-8e63-f70bf208f308
2025-03-18 08:29:39,470 - StoryProcessor - INFO - Using OpenAI backend for request: 803458da-44eb-4f90-8e63-f70bf208f308
2025-03-18 08:29:50,382 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 08:29:50,402 - StoryProcessor - INFO - Generating audio for request: 803458da-44eb-4f90-8e63-f70bf208f308
2025-03-18 08:29:51,464 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/speech "HTTP/1.1 200 OK"
2025-03-18 08:30:26,710 - StoryProcessor - INFO - Audio generated: 803458da-44eb-4f90-8e63-f70bf208f308.mp3
2025-03-18 08:30:26,711 - StoryProcessor - INFO - Story saved: monster-dog-learned-to-fly_20250318083026.html
2025-03-18 08:32:16,715 - StoryProcessor - INFO - Found 1 requests in queue
2025-03-18 08:32:16,716 - StoryProcessor - INFO - Processing request: 201b15cd-d066-4a9c-a1ae-383d48eeddbe
2025-03-18 08:32:16,716 - StoryProcessor - INFO - Using OpenAI backend for request: 201b15cd-d066-4a9c-a1ae-383d48eeddbe
2025-03-18 08:32:28,567 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 08:32:28,571 - StoryProcessor - INFO - Generating audio for request: 201b15cd-d066-4a9c-a1ae-383d48eeddbe
2025-03-18 08:32:30,082 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/speech "HTTP/1.1 200 OK"
2025-03-18 08:32:59,366 - StoryProcessor - INFO - Audio generated: 201b15cd-d066-4a9c-a1ae-383d48eeddbe.mp3
2025-03-18 08:32:59,366 - StoryProcessor - INFO - Story saved: -respect-all-teachers-make-him-the-best_20250318083259.html
2025-03-18 11:38:19,799 - StoryProcessor - INFO - Found 1 requests in queue
2025-03-18 11:38:19,799 - StoryProcessor - INFO - Processing request: ea02e1fd-a638-48e7-9713-c4f6f64d6018
2025-03-18 11:38:19,800 - StoryProcessor - INFO - Using OpenAI backend for request: ea02e1fd-a638-48e7-9713-c4f6f64d6018
2025-03-18 11:38:30,313 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 11:38:30,328 - StoryProcessor - INFO - Generating audio for request: ea02e1fd-a638-48e7-9713-c4f6f64d6018
2025-03-18 11:38:31,874 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/speech "HTTP/1.1 200 OK"
2025-03-18 11:38:56,725 - StoryProcessor - INFO - Audio generated: ea02e1fd-a638-48e7-9713-c4f6f64d6018.mp3
2025-03-18 11:38:56,726 - StoryProcessor - INFO - Story saved: como-brincar-junto-com-os-amigos_20250318113856.html
2025-03-20 00:11:20,060 - StoryProcessor - INFO - Starting story processor. Monitoring queue every 10 seconds
2025-03-20 00:13:00,064 - StoryProcessor - INFO - Found 1 requests in queue
2025-03-20 00:13:00,065 - StoryProcessor - INFO - Processing request: 965033ce-bcf6-4e6b-8508-b017d36fcb78
2025-03-20 00:13:00,065 - StoryProcessor - INFO - Using OpenAI backend for request: 965033ce-bcf6-4e6b-8508-b017d36fcb78
2025-03-20 00:13:04,547 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 00:13:04,552 - StoryProcessor - INFO - Generating audio for request: 965033ce-bcf6-4e6b-8508-b017d36fcb78
2025-03-20 00:13:06,252 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/speech "HTTP/1.1 200 OK"
2025-03-20 00:13:28,260 - StoryProcessor - INFO - Audio generated: 965033ce-bcf6-4e6b-8508-b017d36fcb78.mp3
2025-03-20 00:13:28,260 - StoryProcessor - INFO - Story saved: talk-to-the-prince-of-the-moon_20250320001328.html
2025-03-20 01:07:39,089 - StoryProcessor - INFO - Keyboard interrupt received. Shutting down.
2025-03-20 01:07:50,535 - StoryProcessor - INFO - Story Processor started
2025-03-20 01:09:43,067 - StoryProcessor - INFO - Processing request: e48f040e-c73b-4567-9734-58cb5835934b.json
2025-03-20 01:09:43,067 - StoryProcessor - INFO - Generating story for request e48f040e-c73b-4567-9734-58cb5835934b using openai backend
2025-03-20 01:09:43,068 - StoryProcessor - ERROR - Error generating story with OpenAI: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-03-20 01:09:43,068 - StoryProcessor - ERROR - Error processing request e48f040e-c73b-4567-9734-58cb5835934b: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-03-20 01:12:19,247 - StoryProcessor - INFO - Story Processor started
2025-03-20 01:15:59,301 - StoryProcessor - INFO - Processing request: b4663247-df08-4bad-b02e-a8d07ed528f5.json
2025-03-20 01:15:59,302 - StoryProcessor - INFO - Generating story for request b4663247-df08-4bad-b02e-a8d07ed528f5 using deepseek backend
2025-03-20 01:16:28,793 - StoryProcessor - INFO - Generating audio for request b4663247-df08-4bad-b02e-a8d07ed528f5
2025-03-20 01:16:31,063 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/speech "HTTP/1.1 200 OK"
2025-03-20 01:16:51,770 - StoryProcessor - INFO - Audio generated: b4663247-df08-4bad-b02e-a8d07ed528f5.mp3
2025-03-20 01:16:51,770 - StoryProcessor - INFO - Successfully processed request b4663247-df08-4bad-b02e-a8d07ed528f5
2025-03-20 01:16:52,271 - StoryProcessor - INFO - Processing request: 3400eb90-722a-4758-9edb-163f2381b7e7.json
2025-03-20 01:16:52,272 - StoryProcessor - INFO - Generating story for request 3400eb90-722a-4758-9edb-163f2381b7e7 using deepseek backend
2025-03-20 01:17:27,227 - StoryProcessor - INFO - Generating audio for request 3400eb90-722a-4758-9edb-163f2381b7e7
2025-03-20 01:17:29,527 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/speech "HTTP/1.1 200 OK"
2025-03-20 01:18:07,313 - StoryProcessor - INFO - Audio generated: 3400eb90-722a-4758-9edb-163f2381b7e7.mp3
2025-03-20 01:18:07,314 - StoryProcessor - INFO - Successfully processed request 3400eb90-722a-4758-9edb-163f2381b7e7
2025-03-20 01:18:07,815 - StoryProcessor - INFO - Processing request: c18dc309-33e9-4109-a724-8d1aac58a358.json
2025-03-20 01:18:07,815 - StoryProcessor - INFO - Generating story for request c18dc309-33e9-4109-a724-8d1aac58a358 using openai backend
2025-03-20 01:18:13,154 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 01:18:13,170 - StoryProcessor - INFO - Generating audio for request c18dc309-33e9-4109-a724-8d1aac58a358
2025-03-20 01:18:14,985 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/speech "HTTP/1.1 200 OK"
2025-03-20 01:18:35,707 - StoryProcessor - INFO - Audio generated: c18dc309-33e9-4109-a724-8d1aac58a358.mp3
2025-03-20 01:18:35,708 - StoryProcessor - INFO - Successfully processed request c18dc309-33e9-4109-a724-8d1aac58a358
2025-03-20 01:18:36,209 - StoryProcessor - INFO - Processing request: b09dda3c-4280-4be8-bc91-c75feca31f74.json
2025-03-20 01:18:36,210 - StoryProcessor - INFO - Generating story for request b09dda3c-4280-4be8-bc91-c75feca31f74 using openai backend
2025-03-20 01:18:58,471 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 01:18:58,479 - StoryProcessor - INFO - Generating audio for request b09dda3c-4280-4be8-bc91-c75feca31f74
2025-03-20 01:18:59,718 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/speech "HTTP/1.1 200 OK"
2025-03-20 01:19:28,019 - StoryProcessor - INFO - Audio generated: b09dda3c-4280-4be8-bc91-c75feca31f74.mp3
2025-03-20 01:19:28,020 - StoryProcessor - INFO - Successfully processed request b09dda3c-4280-4be8-bc91-c75feca31f74
2025-03-20 01:43:33,233 - StoryProcessor - INFO - Story Processor started
2025-03-20 01:46:55,786 - StoryProcessor - INFO - Processing request: 30e71077-99aa-4abd-81c7-89f4c4ed2f53.json
2025-03-20 01:46:55,786 - StoryProcessor - INFO - Generating story for request 30e71077-99aa-4abd-81c7-89f4c4ed2f53 using anthropic backend
2025-03-20 01:46:56,962 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 404 Not Found"
2025-03-20 01:46:56,965 - StoryProcessor - ERROR - Error generating story with Claude: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-3-haiku'}}
2025-03-20 01:46:56,965 - StoryProcessor - ERROR - Error processing request 30e71077-99aa-4abd-81c7-89f4c4ed2f53: Error code: 404 - {'type': 'error', 'error': {'type': 'not_found_error', 'message': 'model: claude-3-haiku'}}
2025-03-20 01:49:42,031 - StoryProcessor - INFO - Story Processor started
2025-03-20 01:49:57,035 - StoryProcessor - INFO - Processing request: 6bad91f3-8c5c-46dc-8c2f-b3a6fc1e0ad8.json
2025-03-20 01:49:57,036 - StoryProcessor - INFO - Generating story for request 6bad91f3-8c5c-46dc-8c2f-b3a6fc1e0ad8 using anthropic backend
2025-03-20 01:50:08,077 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-03-20 01:50:08,083 - StoryProcessor - INFO - Generating audio for request 6bad91f3-8c5c-46dc-8c2f-b3a6fc1e0ad8
2025-03-20 01:50:10,409 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/speech "HTTP/1.1 200 OK"
2025-03-20 01:50:24,004 - StoryProcessor - INFO - Audio generated: 6bad91f3-8c5c-46dc-8c2f-b3a6fc1e0ad8.mp3
2025-03-20 01:50:24,005 - StoryProcessor - INFO - Successfully processed request 6bad91f3-8c5c-46dc-8c2f-b3a6fc1e0ad8
2025-03-20 02:02:09,678 - StoryProcessor - INFO - Processing request: c707e5d4-b0e8-4343-944a-4563cb95159c.json
2025-03-20 02:02:09,679 - StoryProcessor - INFO - Generating story for request c707e5d4-b0e8-4343-944a-4563cb95159c using openai backend
2025-03-20 02:02:14,029 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 02:02:14,042 - StoryProcessor - INFO - Generating audio for request c707e5d4-b0e8-4343-944a-4563cb95159c
2025-03-20 02:02:15,605 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/speech "HTTP/1.1 200 OK"
2025-03-20 02:02:25,766 - StoryProcessor - INFO - Audio generated: c707e5d4-b0e8-4343-944a-4563cb95159c.mp3
2025-03-20 02:02:25,767 - StoryProcessor - INFO - Successfully processed request c707e5d4-b0e8-4343-944a-4563cb95159c
2025-03-20 02:02:26,268 - StoryProcessor - INFO - Processing request: 7b3225dd-5b4c-4504-b24c-57e75f27bac8.json
2025-03-20 02:02:26,268 - StoryProcessor - INFO - Generating story for request 7b3225dd-5b4c-4504-b24c-57e75f27bac8 using deepseek backend
2025-03-20 02:03:10,421 - StoryProcessor - INFO - Generating audio for request 7b3225dd-5b4c-4504-b24c-57e75f27bac8
2025-03-20 02:03:11,816 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/speech "HTTP/1.1 200 OK"
2025-03-20 02:03:38,015 - StoryProcessor - INFO - Audio generated: 7b3225dd-5b4c-4504-b24c-57e75f27bac8.mp3
2025-03-20 02:03:38,016 - StoryProcessor - INFO - Successfully processed request 7b3225dd-5b4c-4504-b24c-57e75f27bac8
2025-03-20 02:10:16,291 - StoryProcessor - INFO - Story Processor started
2025-03-20 02:11:13,805 - StoryProcessor - INFO - Processing request: 829176f3-4279-4d62-8c1c-a7fdb0245c73.json
2025-03-20 02:11:13,806 - StoryProcessor - INFO - Generating story for request 829176f3-4279-4d62-8c1c-a7fdb0245c73 using openai (gpt-3.5-turbo)
2025-03-20 02:11:16,808 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 02:11:16,814 - StoryProcessor - INFO - Generating audio for request 829176f3-4279-4d62-8c1c-a7fdb0245c73
2025-03-20 02:11:18,649 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/speech "HTTP/1.1 200 OK"
2025-03-20 02:11:37,173 - StoryProcessor - INFO - Audio generated: 829176f3-4279-4d62-8c1c-a7fdb0245c73.mp3
2025-03-20 02:11:37,174 - StoryProcessor - INFO - Successfully processed request 829176f3-4279-4d62-8c1c-a7fdb0245c73
2025-03-20 22:01:32,500 - StoryProcessor - INFO - Story Processor started
2025-03-20 22:02:30,011 - StoryProcessor - INFO - Processing request: 55d8972a-e015-40d3-8110-783c93d31273.json
2025-03-20 22:02:30,012 - StoryProcessor - INFO - Generating story for request 55d8972a-e015-40d3-8110-783c93d31273 using openai (o3-mini)
2025-03-20 22:02:30,897 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-20 22:02:30,899 - StoryProcessor - ERROR - Error generating story with OpenAI: Error code: 400 - {'error': {'message': "Unsupported parameter: 'max_tokens' is not supported with this model. Use 'max_completion_tokens' instead.", 'type': 'invalid_request_error', 'param': 'max_tokens', 'code': 'unsupported_parameter'}}
2025-03-20 22:02:30,899 - StoryProcessor - ERROR - Error processing request 55d8972a-e015-40d3-8110-783c93d31273: Error code: 400 - {'error': {'message': "Unsupported parameter: 'max_tokens' is not supported with this model. Use 'max_completion_tokens' instead.", 'type': 'invalid_request_error', 'param': 'max_tokens', 'code': 'unsupported_parameter'}}
2025-03-20 22:20:57,577 - StoryProcessor - INFO - Story Processor started
2025-03-20 22:21:15,081 - StoryProcessor - INFO - Processing request: a484a0c1-7b87-43b8-8891-d16cf0643dbd.json
2025-03-20 22:21:15,082 - StoryProcessor - INFO - Processing request a484a0c1-7b87-43b8-8891-d16cf0643dbd - Generating story using model o1-mini
2025-03-20 22:21:15,083 - StoryProcessor - INFO - Sending request to OpenRouter: o1-mini for request a484a0c1-7b87-43b8-8891-d16cf0643dbd
2025-03-20 22:21:22,600 - StoryProcessor - INFO - Story generated using model: openai/o1-mini in 7.52 seconds
2025-03-20 22:21:22,601 - StoryProcessor - INFO - Tokens: 182 prompt + 835 completion = 1017 total
2025-03-20 22:21:22,602 - StoryProcessor - INFO - Generating audio for request a484a0c1-7b87-43b8-8891-d16cf0643dbd
2025-03-20 22:21:25,098 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/speech "HTTP/1.1 200 OK"
2025-03-20 22:21:54,603 - StoryProcessor - INFO - Audio generated: a484a0c1-7b87-43b8-8891-d16cf0643dbd.mp3
2025-03-20 22:21:54,604 - StoryProcessor - INFO - Successfully processed request a484a0c1-7b87-43b8-8891-d16cf0643dbd in 39.52 seconds
2025-03-20 22:21:54,604 - StoryProcessor - INFO -   Story generation: 7.52s, Audio: 32.00s, HTML: 0.00s
2025-03-20 22:29:57,967 - StoryProcessor - INFO - Story Processor started
2025-03-20 22:34:23,533 - StoryProcessor - INFO - Story Processor started
2025-03-20 22:43:18,666 - StoryProcessor - INFO - Processing request: 873d4f57-b8a4-4362-a186-cb83d8e631d1.json
2025-03-20 22:43:18,667 - StoryProcessor - INFO - Processing request 873d4f57-b8a4-4362-a186-cb83d8e631d1 - Generating story using model openai/gpt-3.5-turbo
2025-03-20 22:43:18,667 - StoryProcessor - INFO - Sending request to OpenRouter: openai/gpt-3.5-turbo for request 873d4f57-b8a4-4362-a186-cb83d8e631d1
2025-03-20 22:43:28,831 - StoryProcessor - INFO - Story generated using model: openai/gpt-3.5-turbo in 10.16 seconds
2025-03-20 22:43:28,831 - StoryProcessor - INFO - Tokens: 315 prompt + 624 completion = 939 total
2025-03-20 22:43:28,833 - StoryProcessor - INFO - Generating audio for request 873d4f57-b8a4-4362-a186-cb83d8e631d1
2025-03-20 22:43:31,994 - openai._base_client - INFO - Retrying request to /audio/speech in 0.401641 seconds
2025-03-20 22:43:33,863 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/speech "HTTP/1.1 200 OK"
2025-03-20 22:43:50,841 - StoryProcessor - INFO - Audio generated: 873d4f57-b8a4-4362-a186-cb83d8e631d1.mp3
2025-03-20 22:43:50,842 - StoryProcessor - INFO - Successfully processed request 873d4f57-b8a4-4362-a186-cb83d8e631d1 in 32.18 seconds
2025-03-20 22:43:50,842 - StoryProcessor - INFO -   Story generation: 10.17s, Audio: 22.01s, HTML: 0.00s
2025-03-20 22:57:28,044 - StoryProcessor - INFO - Story Processor started
2025-03-20 23:06:43,184 - StoryProcessor - INFO - Processing request: 318a7de7-3c3b-469f-b45d-3abd59143a42.json
2025-03-20 23:06:43,184 - StoryProcessor - INFO - Processing request 318a7de7-3c3b-469f-b45d-3abd59143a42 - Generating story using model anthropic/claude-3-5-sonnet-20240620
2025-03-20 23:06:43,185 - StoryProcessor - INFO - Sending request to OpenRouter: anthropic/claude-3-5-sonnet-20240620 for request 318a7de7-3c3b-469f-b45d-3abd59143a42
2025-03-20 23:06:44,504 - StoryProcessor - ERROR - Error generating story with OpenRouter after 1.32s: 400 Client Error: Bad Request for url: https://openrouter.ai/api/v1/chat/completions
2025-03-20 23:06:44,506 - StoryProcessor - ERROR - Error processing request 318a7de7-3c3b-469f-b45d-3abd59143a42 after 1.32s: 400 Client Error: Bad Request for url: https://openrouter.ai/api/v1/chat/completions
2025-03-20 23:06:44,507 - StoryProcessor - ERROR - Traceback (most recent call last):
  File "/home/felix/story/story2/story_processor.py", line 581, in process_request
    story = generate_story_openrouter(request_data)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/felix/story/story2/story_processor.py", line 297, in generate_story_openrouter
    response.raise_for_status()
  File "/home/felix/story/story2/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 400 Client Error: Bad Request for url: https://openrouter.ai/api/v1/chat/completions

2025-03-20 23:07:22,516 - StoryProcessor - INFO - Processing request: 326a6c88-7151-4581-a6a0-78f91244c999.json
2025-03-20 23:07:22,517 - StoryProcessor - INFO - Processing request 326a6c88-7151-4581-a6a0-78f91244c999 - Generating story using model openai/gpt-3.5-turbo
2025-03-20 23:07:22,517 - StoryProcessor - INFO - Sending request to OpenRouter: openai/gpt-3.5-turbo for request 326a6c88-7151-4581-a6a0-78f91244c999
2025-03-20 23:07:32,807 - StoryProcessor - INFO - Story generated using model: openai/gpt-3.5-turbo in 10.29 seconds
2025-03-20 23:07:32,807 - StoryProcessor - INFO - Tokens: 518 prompt + 735 completion = 1253 total
2025-03-20 23:07:32,808 - StoryProcessor - INFO - Generating audio for request 326a6c88-7151-4581-a6a0-78f91244c999
2025-03-20 23:07:34,927 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/speech "HTTP/1.1 200 OK"
2025-03-20 23:08:08,059 - StoryProcessor - INFO - Audio generated: 326a6c88-7151-4581-a6a0-78f91244c999.mp3
2025-03-20 23:08:08,060 - StoryProcessor - INFO - Successfully processed request 326a6c88-7151-4581-a6a0-78f91244c999 in 45.54 seconds
2025-03-20 23:08:08,060 - StoryProcessor - INFO -   Story generation: 10.29s, Audio: 35.25s, HTML: 0.00s
2025-03-20 23:45:53,662 - StoryProcessor - INFO - Story Processor started
2025-03-20 23:47:08,680 - StoryProcessor - INFO - Processing request: 3e9f5c40-4649-4332-a627-9989d8176fde.json
2025-03-20 23:47:08,681 - StoryProcessor - INFO - Processing request 3e9f5c40-4649-4332-a627-9989d8176fde - Generating story using model mistralai/mistral-saba
2025-03-20 23:47:08,681 - StoryProcessor - INFO - Sending request to OpenRouter: mistralai/mistral-saba for request 3e9f5c40-4649-4332-a627-9989d8176fde
2025-03-20 23:47:18,505 - StoryProcessor - INFO - Story generated using model: mistralai/mistral-saba in 9.82 seconds
2025-03-20 23:47:18,506 - StoryProcessor - INFO - Tokens: 409 prompt + 804 completion = 1213 total
2025-03-20 23:47:18,507 - StoryProcessor - INFO - Generating audio for request 3e9f5c40-4649-4332-a627-9989d8176fde
2025-03-20 23:47:20,371 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/audio/speech "HTTP/1.1 200 OK"
2025-03-20 23:47:57,383 - StoryProcessor - INFO - Audio generated: 3e9f5c40-4649-4332-a627-9989d8176fde.mp3
2025-03-20 23:47:57,383 - StoryProcessor - INFO - Successfully processed request 3e9f5c40-4649-4332-a627-9989d8176fde in 48.70 seconds
2025-03-20 23:47:57,383 - StoryProcessor - INFO -   Story generation: 9.83s, Audio: 38.88s, HTML: 0.00s
